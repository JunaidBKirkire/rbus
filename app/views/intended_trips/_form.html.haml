= form_for @intended_trip do |f|
  -if @intended_trip.errors.any? || (@intended_trip.user && @intended_trip.user.errors.any?)
    #error_explanation
      %h2= "#{pluralize(@intended_trip.errors.count + @intended_trip.user.errors.count, "error")} prohibited this intended_trip from being saved:"
      %ul
        - (@intended_trip.errors.full_messages + @intended_trip.user.errors.full_messages).each do |msg|
          %li= msg
  %label I live at
  = f.select :from_stop_id, Hash[BusStop.all(:order => [:name]).map{|b| [b.name, b.id]}], {:prompt => "closest starting stop"}, :class => "chosen span4", :'data-placeholder' => "closest starting bus stop"
  %br
  %label and work at
  = f.select :to_stop_id, Hash[BusStop.all(:order => [:name]).map{|b| [b.name, b.id]}], {:prompt => "closest destination stop"}, :class => "chosen span4"
  %br
  %label on
  = f.select :on, ["weekdays", "weekdays and saturday", "all days"]
  %br
  - unless current_user
    = f.fields_for :user do |u|
      %label Email
      = u.text_field :email
      %br
      %label Password
      = u.text_field :password, :placeholder => "please choose a password", :type => "password"
      %br
      %label Confirm Password
      = u.text_field :password_confirmation, :placeholder => "please type your password again", :type => "password"
  %br
  = f.submit "Register my Trip", :class => "btn btn-info"
  
